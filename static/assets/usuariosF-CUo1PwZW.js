import"./main-B6jvjcsM.js";import{S as i}from"./sweetalert2.esm.all-BccGxJ0c.js";import{m as h,s as d}from"./jmpTools-DpHYBAf9.js";/* empty css                   */const w=async t=>await(await fetch("/api/auth/user",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),p=async t=>await(await fetch("/api/auth/user",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();window._id="";document.addEventListener("DOMContentLoaded",async()=>{const n=new URL(window.location.href).searchParams.get("_id");if(n){document.getElementById("title-form").innerText="Editar usuario";try{const e=await(await fetch(`/api/auth/user/${n}`,{method:"GET",credentials:"include"})).json();window._id=e._id,delete e._id,delete e.__v,delete e.state,delete e.userCreationDate,delete e.password,e["document-identification"]=e.typeIdentifier,delete e.typeIdentifier,e.birthdate=new Date(e.birthdate).toISOString().split("T")[0];const s=Object.keys(e);for(let a=0;a<s.length;a++){const r=s[a];document.getElementById(r).value=e[r]}document.querySelector("button[type=submit]").innerText="Editar"}catch(o){console.error("Error al cargar los datos del usuario",o)}}});const m=document.getElementById("form-user"),c=m.querySelectorAll("input"),l=document.getElementById("document-identification"),u=document.getElementById("dropdown-document").querySelectorAll("li");for(let t=0;t<u.length;t++)u[t].addEventListener("click",o=>{l.setAttribute("value",o.target.getAttribute("value")),l.innerText=o.target.innerText});for(let t=0;t<c.length;t++){const n=c[t];n.addEventListener("focus",()=>{n.classList.remove("is-invalid")})}m.addEventListener("submit",async function(t){t.preventDefault();let n=!0;const o=t.target.querySelectorAll("input"),e={};for(let s=0;s<o.length;s++){const a=o[s];e[a.id]=a.value,(a.value===void 0||a.value==="")&&(o[s].classList.add("is-invalid"),n=!1)}if(!n)return"error";h(e["password-a"],e["password-b"])?(e.rol=document.getElementById("rol").value,e.typeIdentifier=document.getElementById("document-identification").innerText,e.password=e["password-a"],delete e["password-a"],delete e["password-b"],window._id==""?(await w(e)).success!=null?i.fire({title:"Se ha creadp un usuario con exito",icon:"success",timer:1e3}):i.fire({title:"No se han podido crear un usuario",icon:"error",timer:1e3}):(await p({id:window._id,changes:e})).success!=null?i.fire({title:"Se han hecho  los cambios con exito",icon:"success",timer:1e3}):i.fire({title:"No se han podido hacer los cambios",icon:"error",timer:1e3})):alert("Passwords do not match or are not strong enough.")});document.getElementById("shw-a").addEventListener("mousedown",t=>{d("password-a","shw-a")});document.getElementById("shw-a").addEventListener("mouseup",t=>{d("password-a","shw-a")});document.getElementById("shw-b").addEventListener("mousedown",()=>d("password-b","shw-b"));document.getElementById("shw-b").addEventListener("mouseup",()=>d("password-b","shw-b"));
