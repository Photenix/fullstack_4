import"./modulepreload-polyfill-B5Qt9EMX.js";import"./main-C5KVrVRe.js";import{S as i}from"./sweetalert2.esm.all-BccGxJ0c.js";/* empty css                   */const c=(e,t,s)=>{const n={Leer:"read",Crear:"create",Actualizar:"update",Eliminar:"delete",Des:"download"}[t];return`<input type="checkbox" class="btn-check" id="${"pp-"+e+"-"+t}" autocomplete="off" ${s?"checked":""} coffe="${n}">
    <label class="btn btn-outline-primary" for="${"pp-"+e+"-"+t}">${t}</label><br>`},m=(e,t,s)=>{const o=document.getElementById("permissions+privileges"),n=t;o.innerHTML+=`<tr>
      <th scope="row">${n}</th>
      <td>${c(e,"Leer",s.read)}</td>
      <td>${c(e,"Crear",s.create)}</td>
      <td>${c(e,"Actualizar",s.update)}</td>
      <td>${c(e,"Eliminar",s.delete)}</td>
      <td>${c(e,"Des",s.download)}</td>
    </tr>`},l={rol:"Rol",user:"Usuario",access:"Acceso",shopping:"Compra",supplier:"Proveedores",product:"Productos",client:"Cliente",productOrder:"Orden de producto",sale:"Venta",Rol:"rol",Usuario:"user",Acceso:"access",Compra:"shopping",Proveedores:"supplier",Productos:"product",Cliente:"client","Orden de producto":"productOrder",Venta:"sale"};document.addEventListener("DOMContentLoaded",async()=>{const t=await(await fetch("/api/auth/rol",{credentials:"include"})).json();k(t),console.log(t)});window._idUser="";const f=async(e="0",t)=>{const s=document.getElementById("exampleModalLabel");s.innerHTML=`Edicion de <b>${t}</b>`,_idUser=e,t==="Administrador"&&(t="Admin"),t==="Empleado"&&(t="Worker");const o=await fetch("/api/auth/rol/"+t,{credentials:"include"}),{permissions:n}=await o.json();u.innerHTML="",Object.entries(n).forEach(([r,a],d)=>{m(d,l[r],a)})},b=async e=>{const t=u.querySelectorAll("tr"),s={};t.forEach(o=>{let n=o.querySelector("th").innerText;n=l[n],s[n]={},o.querySelectorAll("input").forEach(a=>{s[n][a.getAttribute("coffe")]=a.checked})}),C(_idUser,s)},y=document.querySelector("tbody");document.querySelector("#search-rol");const w=document.getElementById("rol-update");let u=document.getElementById("permissions+privileges");w.addEventListener("click",e=>b());const g=(e,t,s)=>{const o=document.createElement("tr"),n=`rol-id-${e}`;o.setAttribute("id",e),o.innerHTML=`<td>${t}</td>
        <td>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="${n}" ${s?"checked":""}>
        </div>
        </td>
        <td>
            <button id="update-rol-id-${e}" class="btn btn-outline-warning" role="button" aria-pressed="true" data-bs-toggle="modal" data-bs-target="#exampleModal"><i class="ti ti-writing-sign"></i></button>
            <!--<button type="button" class="btn btn-outline-danger"><i class="ti ti-trash"></i></button>--!>
        </td>
    `;const r=o.querySelector(`#${n}`);r.addEventListener("change",d=>{i.fire({title:"¿Está seguro de cambiar estado a "+(r.checked?"activo":"inactivo")+"?",text:"El usuario sera notificado de su nuevo estado",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, cambiar!"}).then(p=>{p.isConfirmed?E(e,r.checked).then(h=>{h||(r.checked=!r.checked)}):r.checked=!r.checked})}),o.querySelector(`#update-rol-id-${e}`).addEventListener("click",d=>f(e,t)),y.appendChild(o)},k=e=>{for(const t of e)t.name==="Admin"&&(t.name="Administrador"),t.name==="Worker"&&(t.name="Empleado"),g(t._id,t.name,t.state)},C=async(e,t)=>{const o=await(await fetch("/api/auth/rol",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:t,id:e})})).json();o.success!=!0?i.fire({position:"top-end",title:o.message,icon:"error",showConfirmButton:!1,timer:1e3}):i.fire({position:"top-end",title:"¡Cambios exitosos!",icon:"success",showConfirmButton:!1,timer:1e3})},E=async(e,t)=>{const o=await(await fetch("/api/auth/rol/status",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,state:t})})).json();return o.success!=!0?(i.fire({position:"top-end",title:o.message,icon:"error",showConfirmButton:!1,timer:1e3}),!1):(i.fire({position:"top-end",title:"Cambios exitosos!",icon:"success",showConfirmButton:!1,timer:1e3}),!0)};
