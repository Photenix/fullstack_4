import"./main-DtEDl7Xs.js";import{S as l}from"./sweetalert2.esm.all-BccGxJ0c.js";/* empty css                   */const f={1:{name:"Juan Pérez",email:"juan.perez@example.com",phone:"3105455484",status:!0},2:{name:"María López",email:"maria.lopez@example.com",phone:"3105455484",status:!1},3:{name:"Carlos García",email:"carlos.garcia@example.com",phone:"3115455484",status:!1},4:{name:"Ana Martínez",email:"ana.martinez@example.com",phone:"3125455484",status:!0},5:{name:"Luis Fernández",email:"luis.fernandez@example.com",phone:"3135455484",status:!1},6:{name:"Luis Garcia",email:"luis.garcia@example.com",phone:"3105455484",status:!1}};let p=JSON.parse(localStorage.getItem("user"));(p==null||p==null)&&(localStorage.setItem("user",JSON.stringify(f)),p=f);const B={Admin:"Administrador",Worker:"Empleado"},b=async()=>{const t=await(await fetch("https://boxnovan.onrender.com/api/auth/user",{credentials:"include"})).json();console.log(t[0]),t.forEach(n=>{E(n)})};document.addEventListener("DOMContentLoaded",b);const d=document.querySelector("tbody"),y=document.querySelector("#search-user"),S=e=>{const{username:t,firstName:n,lastName:a,email:s,phone:u,documentNumber:m,typeIdentifier:c,address:o}=e;let i=new Date(e.birthdate);i=i.toLocaleDateString("es-CO"),document.getElementById("detail-title").innerText=`Detalle del usuario ${t}`,document.getElementById("user-name").innerText=`${n} ${a}`,document.getElementById("user-id").innerText=`${c} ${m}`,document.getElementById("user-email").innerText=s,document.getElementById("user-phone").innerText=u,document.getElementById("user-birthday").innerText=i,document.getElementById("user-nickname").innerText=t,document.getElementById("user-address").innerText=o},E=e=>{const{_id:t,documentNumber:n,username:a,email:s,phone:u,state:m}=e,c=B[e.rol],o=document.createElement("tr"),i=`<td><span class="badge rounded-pill text-bg-${c=="Administrador"?"secondary":"success"}">${c}</span></td>`,x=`<a href="./usuario-form.html?_id=${t}" class="btn btn-outline-warning" role="button" aria-pressed="true"><i class="ti ti-writing-sign"></i></a>`;o.innerHTML=`<th scope="row" title="${n}">${n}</th>
        <td title=${a}>${a.substring(0,15)}</td>
        <td title=${s}>${s.substring(0,15)}</td>
        <td>${u}</td>
        ${i}
        <td>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="${t}" ${m?"checked":""}>
        </div>
        </td>
        <td>
            <div class="col">
            <button type="button" class="btn btn-outline-success" title="Ver detalle" data-bs-toggle="modal" data-bs-target="#modal-user"><i class="ti ti-eye"></i></button>
            ${x}
            <button type="button" class="btn btn-outline-danger"><i class="ti ti-trash"></i></button>
            </div>
        </td>
    `;const r=o.querySelector("input"),v=o.querySelector(".btn.btn-outline-danger"),$=o.querySelector(".btn.btn-outline-success");r.addEventListener("change",g=>{l.fire({title:"¿Está seguro de cambiar estado a "+(r.checked?"activo":"inactivo")+"?",text:"El usuario sera notificado de su nuevo estado",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, cambiar!"}).then(h=>{h.isConfirmed?(l.fire({title:"¡Cambio de estado!",text:`El usuario ahora se encuentra en estado ${r.checked?"activo":"inactivo"}`,icon:"success",position:"bottom-end",toast:!0,timer:2e3,showConfirmButton:!1,timerProgressBar:!0}),T(t,r.checked)):r.checked=!r.checked})}),v.addEventListener("click",g=>{l.fire({title:"¿Está seguro de eliminar este usuario?",text:"Una vez eliminado, no se podrá recuperar",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar!"}).then(h=>{h.isConfirmed&&l.fire("Eliminado!","El usuario ha sido eliminado correctamente.","success")})}),$.addEventListener("click",g=>{S(e)}),d.appendChild(o)},T=async(e,t)=>{const a=await(await fetch("https://boxnovan.onrender.com/api/auth/user",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:e,changes:{state:t}})})).json();console.log(a)},k=async(e,t)=>{const n={};n[e]=t;const s=await(await fetch("https://boxnovan.onrender.com/api/auth/user/search",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)})).json();return s.message?[]:[...s]},w=async e=>{const t=document.getElementById("filter-user"),n=e.target.value.length;if(n<4)return n===0&&(d.innerHTML="",b()),null;const a=await k(t.value,e.target.value);d.innerHTML="";for(let s=0;s<a.length;s++)E(a[s]);a.length==0&&(d.innerHTML="<tr><td colspan='5'>No se encontraron resultados</td></tr>")};y.addEventListener("keyup",e=>w(e));y.addEventListener("mousedown",e=>w(e));
